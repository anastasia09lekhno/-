import sys
from assembler import Assembler
from interpreter import Interpreter

def main():
    if len(sys.argv) < 3:
        print("Использование:")
        print("  python main.py assembler <input.asm> <output.bin> [log.yaml]")
        print("  python main.py interpreter <binary_file> <memory_range> <output.yaml>")
        sys.exit(1)

    mode = sys.argv[1]

    if mode == "assembler":
        input_file = sys.argv[2]
        output_file = sys.argv[3]
        log_file = sys.argv[4] if len(sys.argv) > 4 else None
        assembler = Assembler(input_file, output_file, log_file)
        assembler.assemble()

    elif mode == "interpreter":
        binary_file = sys.argv[2]
        memory_range = sys.argv[3]
        output_file = sys.argv[4]
        start, end = map(int, memory_range.split('-'))
        interpreter = Interpreter(binary_file, start, end, output_file)
        interpreter.interpret()

    else:
        print("Неверный режим. Используйте 'assembler' или 'interpreter'.")

if __name__ == "__main__":
    main()
